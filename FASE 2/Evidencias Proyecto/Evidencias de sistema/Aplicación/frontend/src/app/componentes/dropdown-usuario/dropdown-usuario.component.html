<div class="user-profile-container">
  <!-- Botón siempre visible con foto, nombre, rol y chevron -->
  <ion-button fill="clear" id="user-menu-button" (click)="openUserMenu($event)">
    <img src="assets/foto_perfil/perfil_ejemplo.jpg" alt="Foto de perfil" class="profile-picture" />
    <!-- Contenedor para nombre y rol -->
    <div class="user-info">
      <span class="username-text">{{ currentUserName | uppercase }}</span>
      <span class="user-role-text">Conductor</span> <!-- Añade el rol aquí -->
    </div>
    <!-- El icono rota basado en el estado del popover -->
    <ion-icon name="chevron-down-outline" [ngClass]="{'rotate': showPopover}"></ion-icon>
  </ion-button>

  <!-- Popover que contiene solo las opciones del menú -->
  <ion-popover
    trigger="user-menu-button"
    [isOpen]="showPopover"
    [event]="popoverEvent"
    (didDismiss)="closePopover()"
    side="bottom"
    alignment="end"
    class="user-options-popover"
    [dismissOnSelect]="false"
    [showBackdrop]="false"
  >
    <ng-template>
      <ion-list class="popover-menu">
        <ion-item button (click)="goToProfile()">
          <ion-icon name="person-outline" slot="start"></ion-icon>
          <ion-label>Perfil</ion-label>
        </ion-item>
        <ion-item button (click)="openSettings()">
          <ion-icon name="settings-outline" slot="start"></ion-icon>
          <ion-label>Configuración</ion-label>
        </ion-item>
        <ion-item button class="logout" (click)="logout()"> <!-- Llama a logout() -->
          <ion-icon name="log-out-outline" slot="start" class="logout-icon"></ion-icon>
          <ion-label>Cerrar sesión</ion-label>
        </ion-item>
      </ion-list>
    </ng-template>
  </ion-popover>
</div>